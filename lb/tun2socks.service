[Unit]
Description=Tun2Socks
After=network.target

[Service]
Type=simple
User=root
EnvironmentFile=/etc/tun2socks/tun2socks.conf
ExecStartPre=ip tuntap add mode tun dev tun0
ExecStartPre=ip addr add ${TUNIP}/${TUNPREFIX} dev tun0
ExecStartPre=ip link set dev tun0 up
ExecStart=tun2socks -device tun://tun0 -proxy ss://${SSPROTOCOL}:${SSPASSWORD}@${SSIP}:${SSPORT}
ExecStopPost=ip link set dev tun0 down
ExecStopPost=ip link del dev tun0

[Install]
WantedBy=multi-user.target